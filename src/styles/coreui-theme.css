/* CoreUI Theme Customization */

/* Import CoreUI base styles */
@import '@coreui/coreui/dist/css/coreui.min.css';

/* v1.0 – CoreUI Bridge (2025-11-07) */
:root {
  --bs-body-bg: var(--surface-bg);
  --bs-body-color: var(--text-primary);
  --bs-border-color: var(--line-soft);

  /* CoreUI specifics */
  --cui-body-bg: var(--surface-bg);
  --cui-body-color: var(--text-primary);
  --cui-card-bg: var(--surface-card);
  --cui-card-border-color: var(--line-soft);
  --cui-footer-bg: var(--surface-card);

  /* Primary brand bridge */
  --bs-primary: var(--brand-primary);
  --bs-link-color: var(--brand-primary);
  --cui-primary: var(--brand-primary);
  --cui-primary-rgb: 14, 165, 233;

  /* CoreUI semantic colors */
  --cui-success: #198754;
  --cui-success-rgb: 25, 135, 84;
  --cui-warning: #ffc107;
  --cui-warning-rgb: 255, 193, 7;
  --cui-danger: #dc3545;
  --cui-danger-rgb: 220, 53, 69;
  --cui-info: #0dcaf0;
  --cui-info-rgb: 13, 202, 240;
  --filter-icon-color: var(--cui-body-color);

  /* Top Navigation Bridge */
  --cui-header-bg: var(--nav-bg);
  --cui-header-color: var(--nav-text);
  --cui-header-border-color: var(--nav-border);
  --cui-header-hover-bg: var(--nav-hover-bg);
  --cui-header-active-bg: var(--nav-active-bg);
  --cui-header-brand-color: var(--nav-brand);

  /* Validation Report */
  --validation-unit-price-color: #000;

  /* Tiles & Navigation - Landscaper Icon Fill */
  --landscaper-icon-color: #080A0C;
}

/* v1.0 · Dark header contrast fix — keep near other CoreUI var bridges */
[data-theme="dark"] .app-header,
[data-coreui-theme="dark"] .app-header,
.navbar-dark,
.navbar[data-coreui-theme="dark"] {
  --cui-navbar-color: var(--nav-text);
  --cui-navbar-active-color: #ffffff;
  --cui-navbar-brand-color: var(--nav-text);
  --cui-navbar-brand-hover-color: #ffffff;
  --cui-header-brand-color: var(--nav-text);
  --cui-header-brand-hover-color: #ffffff;
  background-color: var(--nav-bg) !important;
  color: var(--nav-text) !important;
}

[data-theme="dark"] .app-header a,
[data-coreui-theme="dark"] .app-header a,
.navbar-dark a {
  color: var(--nav-text) !important;
}

[data-theme='dark'] {
  --bs-body-bg: var(--surface-bg);
  --bs-body-color: var(--text-primary);
  --bs-border-color: var(--line-soft);

  --cui-card-bg: var(--surface-card);
  --cui-card-border-color: var(--line-strong);
  --cui-footer-bg: var(--surface-card);

  /* CoreUI semantic colors - same in dark mode */
  --cui-success: #198754;
  --cui-success-rgb: 25, 135, 84;
  --cui-warning: #ffc107;
  --cui-warning-rgb: 255, 193, 7;
  --cui-danger: #dc3545;
  --cui-danger-rgb: 220, 53, 69;
  --cui-info: #0dcaf0;
  --cui-info-rgb: 13, 202, 240;

  /* Top Navigation Bridge */
  --cui-header-bg: var(--nav-bg);
  --cui-header-color: var(--nav-text);
  --cui-header-border-color: var(--nav-border);
}

/* [data-coreui-theme] attribute selectors for theme switching */
[data-coreui-theme='light'] {
  --cui-body-bg: var(--surface-bg);
  --cui-body-color: var(--text-primary);
  --cui-border-color: var(--line-soft);
  --cui-tertiary-bg: var(--surface-card);
  --cui-secondary-color: var(--text-secondary);
  --cui-card-bg: var(--surface-card);
}

[data-coreui-theme='dark'] {
  --cui-body-bg: var(--surface-bg);
  --cui-body-color: var(--text-primary);
  --cui-border-color: var(--line-strong);
  --cui-tertiary-bg: var(--surface-card);
  --cui-secondary-color: var(--text-secondary);
  --cui-card-bg: var(--surface-card);
  --filter-icon-color: #ffffff;
  --validation-unit-price-color: #07FF8A;
  /* Tiles & Navigation - Landscaper Icon Fill */
  --landscaper-icon-color: #FFFFFF;
}

/* Dark mode button overrides - direct rules, not variables */
[data-coreui-theme='dark'] .btn-warning {
  background-color: rgba(255, 193, 7, 0.2) !important;
  border-color: #ffc107 !important;
  color: #ffc107 !important;
}

[data-coreui-theme='dark'] .btn-warning:hover {
  background-color: rgba(255, 193, 7, 0.3) !important;
  color: #ffc107 !important;
}

[data-coreui-theme='dark'] .btn-success {
  background-color: rgba(25, 135, 84, 0.2) !important;
  border-color: #198754 !important;
  color: #198754 !important;
}

[data-coreui-theme='dark'] .btn-success:hover {
  background-color: rgba(25, 135, 84, 0.3) !important;
  color: #198754 !important;
}

[data-coreui-theme='dark'] .btn-danger {
  background-color: rgba(220, 53, 69, 0.2) !important;
  border-color: #dc3545 !important;
  color: #dc3545 !important;
}

[data-coreui-theme='dark'] .btn-danger:hover {
  background-color: rgba(220, 53, 69, 0.3) !important;
  color: #dc3545 !important;
}

/* Outline buttons get special treatment */
[data-coreui-theme='dark'] .btn-outline-warning {
  border-color: #ffc107 !important;
  color: #ffc107 !important;
  background-color: transparent !important;
}

[data-coreui-theme='dark'] .btn-outline-success {
  border-color: #198754 !important;
  color: #198754 !important;
  background-color: transparent !important;
}

[data-coreui-theme='dark'] .btn-outline-danger {
  border-color: #dc3545 !important;
  color: #dc3545 !important;
  background-color: transparent !important;
}

/* Active state for outline buttons in dark mode */
[data-coreui-theme='dark'] .btn-outline-warning.active {
  background-color: rgba(255, 193, 7, 0.15) !important;
  font-weight: 600 !important;
}

[data-coreui-theme='dark'] .btn-outline-success.active {
  background-color: rgba(25, 135, 84, 0.15) !important;
  font-weight: 600 !important;
}

[data-coreui-theme='dark'] .btn-outline-danger.active {
  background-color: rgba(220, 53, 69, 0.15) !important;
  font-weight: 600 !important;
}

/* Ghost button variants in dark mode */
[data-coreui-theme='dark'] .btn-ghost-primary {
  background-color: transparent !important;
  color: var(--cui-body-color) !important;
  border: none !important;
}

[data-coreui-theme='dark'] .btn-ghost-primary:hover {
  background-color: rgba(var(--cui-primary-rgb), 0.1) !important;
  color: var(--cui-primary) !important;
}

[data-coreui-theme='dark'] .btn-ghost-secondary {
  background-color: transparent !important;
  color: var(--cui-body-color) !important;
  border: none !important;
}

[data-coreui-theme='dark'] .btn-ghost-secondary:hover {
  background-color: var(--cui-tertiary-bg) !important;
  color: var(--cui-body-color) !important;
}

/* Light mode ghost buttons */
.btn-ghost-primary {
  background-color: transparent !important;
  color: var(--cui-body-color) !important;
  border: none !important;
}

.btn-ghost-primary:hover {
  background-color: rgba(var(--cui-primary-rgb), 0.1) !important;
  color: var(--cui-primary) !important;
}

.btn-ghost-secondary {
  background-color: transparent !important;
  color: var(--cui-body-color) !important;
  border: none !important;
}

.btn-ghost-secondary:hover {
  background-color: var(--cui-tertiary-bg) !important;
  color: var(--cui-body-color) !important;
}

/* UI Standards v1.0 · 2025-11-02 */
.tnum {
  font-variant-numeric: tabular-nums;
}

/* Light Theme (Default) - Using CoreUI Modern native variables */
.light-theme {
  /* Backgrounds driven by tokens */
  --cui-body-bg: var(--surface-bg);
  --cui-tertiary-bg: var(--surface-card);
  --cui-secondary-bg: var(--surface-card);
  --cui-body-color: var(--text-primary);
  --cui-border-color: var(--line-soft);

  /* Card styles */
  --cui-card-bg: var(--surface-card);
  --cui-card-border-color: var(--line-soft);
  --cui-card-cap-bg: var(--surface-card);

  /* Primary color - token bridge */
  --cui-primary: var(--brand-primary);
  --cui-primary-rgb: 14, 165, 233;

  /* Text colors */
  --cui-emphasis-color: var(--text-primary);
  --cui-secondary-color: var(--text-secondary);
  --cui-tertiary-color: color-mix(in srgb, var(--text-secondary) 70%, var(--surface-bg));

  /* Forms */
  --cui-input-bg: var(--surface-card);
  --cui-input-border-color: var(--line-soft);
  --cui-input-focus-border-color: var(--brand-primary);

  /* Tables */
  --cui-table-bg: var(--surface-card);
  --cui-table-hover-bg: color-mix(in srgb, var(--surface-card) 92%, var(--surface-bg));
  --cui-table-striped-bg: color-mix(in srgb, var(--surface-card) 96%, var(--surface-bg));

  /* Shadows - CoreUI Modern native values */
  --cui-box-shadow: 0 0.5rem 1rem rgba(8, 10, 12, 0.15);
  --cui-box-shadow-sm: 0 0.125rem 0.25rem rgba(8, 10, 12, 0.075);
  --cui-box-shadow-lg: 0 1rem 3rem rgba(8, 10, 12, 0.175);
}

/* Dark Theme */
.dark-theme {
  --cui-body-bg: var(--surface-bg);
  --cui-body-color: var(--text-primary);
  --cui-border-color: var(--line-strong);

  /* Card styles */
  --cui-card-bg: var(--surface-card);
  --cui-card-border-color: var(--line-strong);
  --cui-card-cap-bg: var(--surface-card);

  /* Primary color */
  --cui-primary: var(--brand-primary);
  --cui-primary-rgb: 14, 165, 233;

  /* Text colors */
  --cui-emphasis-color: var(--text-primary);
  --cui-secondary-color: var(--text-secondary);
  --cui-tertiary-color: color-mix(in srgb, var(--text-secondary) 70%, var(--surface-bg));

  /* Forms */
  --cui-input-bg: var(--surface-card);
  --cui-input-border-color: var(--line-strong);
  --cui-input-focus-border-color: var(--brand-primary);
  --cui-input-color: var(--text-primary);

  /* Tables */
  --cui-table-bg: var(--surface-card);
  --cui-table-hover-bg: color-mix(in srgb, var(--surface-card) 90%, var(--surface-bg));
  --cui-table-striped-bg: color-mix(in srgb, var(--surface-card) 80%, var(--surface-bg));
  --cui-table-color: var(--text-primary);

  /* Shadows */
  --cui-box-shadow: 0 1px 3px rgba(0, 0, 0, 0.4), 0 1px 2px rgba(0, 0, 0, 0.3);
  --cui-box-shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.5), 0 4px 6px -2px rgba(0, 0, 0, 0.4);
}

/* Body background */
body {
  background-color: var(--cui-body-bg);
  color: var(--cui-body-color);
  transition: background-color 0.3s ease, color 0.3s ease;
}

/* Card customization */
.card {
  background-color: var(--cui-card-bg);
  border-color: var(--cui-card-border-color);
  box-shadow: var(--cui-box-shadow-sm);
  border-radius: 0.375rem;
}

.card-header,
.card > .card-header {
  background-color: var(--cui-card-cap-bg) !important;
  border-bottom-color: var(--cui-border-color);
}

/* Ensure light theme card headers use the correct background */
.light-theme .card-header,
.light-theme .card > .card-header {
  background-color: var(--surface-card-header) !important;
}

/* Form controls */
.form-control,
.form-select {
  background-color: var(--cui-input-bg);
  border-color: var(--cui-input-border-color);
  color: var(--cui-input-color, var(--cui-body-color));
}

.form-control:focus,
.form-select:focus {
  border-color: var(--cui-input-focus-border-color);
  box-shadow: 0 0 0 0.25rem rgba(var(--cui-primary-rgb), 0.25);
}

/* Floating labels - space-efficient form inputs */
.form-floating {
  position: relative;
}

.form-floating > .form-control {
  height: calc(3.5rem + 2px);
  line-height: 1.25;
  padding: 1rem 0.75rem;
}

.form-floating > label {
  position: absolute;
  top: 0;
  left: 0;
  height: 100%;
  padding: 1rem 0.75rem;
  pointer-events: none;
  border: 1px solid transparent;
  transform-origin: 0 0;
  transition: opacity 0.1s ease-in-out, transform 0.1s ease-in-out;
  color: var(--cui-secondary-color);
}

.form-floating > .form-control:focus ~ label,
.form-floating > .form-control:not(:placeholder-shown) ~ label,
.form-floating > .form-select:focus ~ label,
.form-floating > .form-select.has-value ~ label,
.form-floating > .form-select:not([value=""]) ~ label {
  opacity: 0.65;
  transform: scale(0.85) translateY(-0.5rem) translateX(0.15rem);
}

.form-floating > .form-control:focus ~ label {
  color: var(--cui-primary);
}

/* Tables */
.table {
  color: var(--cui-table-color, var(--cui-body-color));
}

/* Table headers - override all backgrounds including Tailwind classes */
thead,
thead tr,
thead th,
.table thead,
.table thead tr,
.table thead th {
  background-color: var(--surface-card-header) !important;
}

/* Table hover - general rule comes first */
.table-hover tbody tr:hover {
  background-color: var(--cui-table-hover-bg);
}

/* Group rows - maintain background even on hover (more specific, comes after) */
.table.table-hover tbody tr.budget-group-row,
.table-hover tbody tr.budget-group-row {
  background-color: var(--surface-subheader) !important;
}

.table.table-hover tbody tr.budget-group-row:hover,
.table-hover tbody tr.budget-group-row:hover {
  background-color: var(--surface-subheader) !important;
  filter: brightness(0.97);
}

.table-striped tbody tr:nth-of-type(odd) {
  background-color: var(--cui-table-striped-bg);
}

/* Header */
.header {
  background-color: var(--cui-header-bg);
  border-bottom-color: var(--cui-header-border-color);
  color: var(--cui-header-color);
}

/* Buttons */
.btn-primary {
  background-color: var(--cui-primary);
  border-color: var(--cui-primary);
}

.btn-primary:hover {
  background-color: color-mix(in srgb, var(--cui-primary) 85%, black);
  border-color: color-mix(in srgb, var(--cui-primary) 85%, black);
}

/* Smooth transitions for theme changes */
* {
  transition: background-color 0.3s ease, color 0.3s ease, border-color 0.3s ease;
}

/* Disable transitions on theme attributes to prevent flash */
[data-coreui-theme] {
  transition: none !important;
}

/* ===== LIGHT THEME OVERRIDES ===== */
/* Main page background - CoreUI Modern light grey */
.light-theme .min-h-screen,
.light-theme main,
.light-theme [role="main"] {
  background-color: var(--surface-page-bg) !important;
}

/* Background colors - convert dark to light */
.light-theme .bg-gray-950,
.light-theme .bg-gray-900,
.light-theme .bg-gray-800 {
  background-color: #ffffff !important;
}

.light-theme .bg-gray-700 {
  background-color: #f9fafb !important;
}

.light-theme .bg-gray-600 {
  background-color: #6366f1 !important;
  color: #ffffff !important;
}

.light-theme .bg-gray-900\/60,
.light-theme .bg-gray-900\/30 {
  background-color: #f9fafb !important;
}

/* Border colors - CoreUI Modern style (#dbdfe6 = --cui-gray-300) */
.light-theme .border-gray-800,
.light-theme .border-gray-700,
.light-theme .border-gray-600 {
  border-color: #dbdfe6 !important;
  box-shadow: 0 0.125rem 0.25rem rgba(8, 10, 12, 0.075) !important;
}

.light-theme .border-gray-700\/60 {
  border-color: #dbdfe6 !important;
  box-shadow: 0 0.125rem 0.25rem rgba(8, 10, 12, 0.075) !important;
}

/* Make all borders CoreUI Modern style with subtle shadow */
.light-theme .border {
  border-color: #dbdfe6 !important;
  box-shadow: 0 0.125rem 0.25rem rgba(8, 10, 12, 0.075) !important;
}

.light-theme .rounded-lg,
.light-theme .rounded {
  border-color: #dbdfe6 !important;
  box-shadow: 0 0.125rem 0.25rem rgba(8, 10, 12, 0.075) !important;
}

/* Text colors - ensure readability */
.light-theme .text-white {
  color: #111827 !important;
}

/* Royal blue buttons keep white text for contrast */
.light-theme button.bg-blue-600,
.light-theme button.bg-blue-700,
.light-theme .btn.bg-blue-600,
.light-theme .btn.bg-blue-700,
.light-theme [role="button"].bg-blue-600,
.light-theme [role="button"].bg-blue-700,
.light-theme a.bg-blue-600,
.light-theme a.bg-blue-700 {
  color: #ffffff !important;
}

.light-theme .bg-blue-600.text-white,
.light-theme .bg-blue-700.text-white {
  color: #ffffff !important;
}

.light-theme .text-gray-300 {
  color: #374151 !important;
}

.light-theme .text-gray-400 {
  color: #6b7280 !important;
}

.light-theme .text-gray-500 {
  color: #9ca3af !important;
}

/* Color badges and highlights - maintain readability */
.light-theme .bg-blue-900\/30,
.light-theme .bg-blue-900 {
  background-color: #dbeafe !important;
}

.light-theme .border-blue-700 {
  border-color: #3b82f6 !important;
}

.light-theme .text-blue-300 {
  color: #2563eb !important;
  font-weight: 600 !important;
}

.light-theme .bg-purple-300,
.light-theme .bg-purple-400 {
  background-color: #c4b5fd !important;
  color: #5b21b6 !important;
}

.light-theme .bg-indigo-500\/20 {
  background-color: #e0e7ff !important;
}

.light-theme .bg-yellow-900\/30,
.light-theme .bg-yellow-900 {
  background-color: #fef3c7 !important;
}

.light-theme .border-yellow-700 {
  border-color: #f59e0b !important;
}

.light-theme .text-yellow-300 {
  color: #d97706 !important;
  font-weight: 600 !important;
}

.light-theme .bg-red-900\/30,
.light-theme .bg-red-900 {
  background-color: #fee2e2 !important;
}

.light-theme .border-red-700 {
  border-color: #ef4444 !important;
}

.light-theme .text-red-300 {
  color: #dc2626 !important;
}

.light-theme .bg-green-900\/30,
.light-theme .bg-green-900 {
  background-color: #d1fae5 !important;
}

.light-theme .text-green-400,
.light-theme .text-green-300 {
  color: #16a34a !important;
  font-weight: 600 !important;
}

.light-theme .text-emerald-300 {
  color: #059669 !important;
  font-weight: 700 !important;
}

.light-theme .text-sky-300 {
  color: #0284c7 !important;
  font-weight: 700 !important;
}

.light-theme .text-amber-300 {
  color: #d97706 !important;
  font-weight: 700 !important;
}

/* Button overrides for light theme */
.light-theme .bg-blue-600 {
  background-color: #2563eb !important;
}

.light-theme .hover\:bg-blue-700:hover {
  background-color: #1d4ed8 !important;
}

.light-theme .bg-green-600 {
  background-color: #16a34a !important;
}

.light-theme .hover\:bg-green-700:hover {
  background-color: #15803d !important;
}

/* Operations page tiles - make them pop with solid background */
.light-theme [style*="--cui-primary-bg"],
.light-theme [style*="--cui-success-bg"],
.light-theme [style*="--cui-info-bg"],
.light-theme [style*="--cui-warning-bg"] {
  background-color: var(--surface-operations-tile) !important;
}

/* Specific component fixes */
.light-theme .bg-indigo-500 {
  background-color: #6366f1 !important;
}

.light-theme .hover\:bg-indigo-400:hover {
  background-color: #818cf8 !important;
}

/* Keep dark theme looking good */
.dark-theme .bg-gray-800 {
  background-color: #1f2937 !important;
}

.dark-theme .bg-gray-900 {
  background-color: #111827 !important;
}

.dark-theme .bg-gray-950 {
  background-color: #030712 !important;
}

.dark-theme .bg-gray-700 {
  background-color: #374151 !important;
}

.dark-theme .border-gray-700 {
  border-color: #374151 !important;
}

.dark-theme .border-gray-800 {
  border-color: #1f2937 !important;
}

.dark-theme .text-white {
  color: #ffffff !important;
}

.dark-theme .text-gray-300 {
  color: #d1d5db !important;
}

.dark-theme .text-gray-400 {
  color: #9ca3af !important;
}

.dark-theme .text-gray-500 {
  color: #6b7280 !important;
}

/* ==========================================================================
   TILES & NAVIGATION - Landscaper Icon
   Light mode: #080A0C (near-black), Dark mode: #FFFFFF (white)
   Apply to parent element - icon uses currentColor for fill
   ========================================================================== */

.landscaper-icon-themed {
  color: var(--landscaper-icon-color);
}

.landscaper-icon-themed svg {
  fill: var(--landscaper-icon-color);
}
