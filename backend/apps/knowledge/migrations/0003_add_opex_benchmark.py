# Generated by Django 5.0.1 on 2026-01-15 20:16

import django.db.models.deletion
from django.db import migrations, models


class Migration(migrations.Migration):

    dependencies = [
        ('knowledge', '0002_doc_processing_queue'),
    ]

    operations = [
        migrations.CreateModel(
            name='AssumptionHistory',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('organization_id', models.BigIntegerField(blank=True, null=True)),
                ('project_id', models.BigIntegerField(blank=True, null=True)),
                ('property_type', models.CharField(max_length=50)),
                ('property_subtype', models.CharField(blank=True, max_length=100, null=True)),
                ('market', models.CharField(blank=True, max_length=100, null=True)),
                ('submarket', models.CharField(blank=True, max_length=100, null=True)),
                ('assumption_category', models.CharField(max_length=100)),
                ('assumption_key', models.CharField(max_length=200)),
                ('assumption_value', models.DecimalField(blank=True, decimal_places=6, max_digits=20, null=True)),
                ('assumption_text', models.TextField(blank=True, null=True)),
                ('assumption_unit', models.CharField(blank=True, max_length=50, null=True)),
                ('context_json', models.JSONField(default=dict)),
                ('source_type', models.CharField(choices=[('user_input', 'User Input'), ('ai_suggestion', 'AI Suggestion'), ('document_extract', 'Document Extraction')], max_length=50)),
                ('source_reference', models.TextField(blank=True, null=True)),
                ('confidence_score', models.DecimalField(decimal_places=2, default=1.0, max_digits=3)),
                ('was_modified', models.BooleanField(default=False)),
                ('original_value', models.DecimalField(blank=True, decimal_places=6, max_digits=20, null=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
            ],
            options={
                'db_table': 'landscape"."tbl_assumption_history',
                'ordering': ['-created_at'],
                'managed': False,
            },
        ),
        migrations.CreateModel(
            name='UserComparable',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('organization_id', models.BigIntegerField(blank=True, null=True)),
                ('project_id', models.BigIntegerField(blank=True, null=True)),
                ('comparable_type', models.CharField(choices=[('sale', 'Sale Comparable'), ('lease', 'Lease Comparable'), ('rent', 'Rent Comparable'), ('expense', 'Expense Comparable')], max_length=50)),
                ('property_name', models.CharField(max_length=500)),
                ('property_address', models.TextField(blank=True, null=True)),
                ('property_type', models.CharField(max_length=50)),
                ('property_subtype', models.CharField(blank=True, max_length=100, null=True)),
                ('market', models.CharField(blank=True, max_length=100, null=True)),
                ('submarket', models.CharField(blank=True, max_length=100, null=True)),
                ('size_value', models.DecimalField(blank=True, decimal_places=2, max_digits=15, null=True)),
                ('size_unit', models.CharField(blank=True, max_length=50, null=True)),
                ('year_built', models.IntegerField(blank=True, null=True)),
                ('transaction_date', models.DateField(blank=True, null=True)),
                ('price_value', models.DecimalField(blank=True, decimal_places=2, max_digits=15, null=True)),
                ('price_unit', models.CharField(blank=True, max_length=50, null=True)),
                ('cap_rate', models.DecimalField(blank=True, decimal_places=4, max_digits=5, null=True)),
                ('noi', models.DecimalField(blank=True, decimal_places=2, max_digits=15, null=True)),
                ('metrics_json', models.JSONField(default=dict)),
                ('source_type', models.CharField(choices=[('user_input', 'User Input'), ('document_extract', 'Document Extraction'), ('market_data', 'Market Data')], max_length=50)),
                ('source_reference', models.TextField(blank=True, null=True)),
                ('source_document_id', models.BigIntegerField(blank=True, null=True)),
                ('confidence_score', models.DecimalField(decimal_places=2, default=1.0, max_digits=3)),
                ('is_verified', models.BooleanField(default=False)),
                ('notes', models.TextField(blank=True, null=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
            ],
            options={
                'db_table': 'landscape"."tbl_user_comparables',
                'ordering': ['-transaction_date', '-created_at'],
                'managed': False,
            },
        ),
        migrations.CreateModel(
            name='UserDocumentChunk',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('document_id', models.BigIntegerField()),
                ('project_id', models.BigIntegerField(blank=True, null=True)),
                ('organization_id', models.BigIntegerField(blank=True, null=True)),
                ('document_name', models.CharField(max_length=500)),
                ('document_type', models.CharField(blank=True, max_length=100, null=True)),
                ('chunk_index', models.IntegerField()),
                ('content', models.TextField()),
                ('content_type', models.CharField(default='text', max_length=50)),
                ('page_number', models.IntegerField(blank=True, null=True)),
                ('section_path', models.CharField(blank=True, max_length=500, null=True)),
                ('property_type', models.CharField(blank=True, max_length=50, null=True)),
                ('entities_json', models.JSONField(default=dict)),
                ('token_count', models.IntegerField(blank=True, null=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
            ],
            options={
                'db_table': 'landscape"."tbl_user_document_chunks',
                'ordering': ['document_id', 'chunk_index'],
                'managed': False,
            },
        ),
        migrations.CreateModel(
            name='PlatformKnowledge',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('document_key', models.CharField(max_length=100, unique=True)),
                ('title', models.CharField(max_length=500)),
                ('subtitle', models.CharField(blank=True, max_length=500, null=True)),
                ('edition', models.CharField(blank=True, max_length=50, null=True)),
                ('publisher', models.CharField(blank=True, max_length=255, null=True)),
                ('publication_year', models.IntegerField(blank=True, null=True)),
                ('isbn', models.CharField(blank=True, max_length=20, null=True)),
                ('knowledge_domain', models.CharField(choices=[('valuation', 'Valuation'), ('cost', 'Cost'), ('market', 'Market'), ('legal', 'Legal'), ('standards', 'Standards'), ('development', 'Development'), ('operating_expenses', 'Operating Expenses'), ('valuation_methodology', 'Valuation Methodology'), ('market_data', 'Market Data'), ('legal_regulatory', 'Legal/Regulatory'), ('cost_estimation', 'Cost Estimation'), ('other', 'Other')], max_length=100)),
                ('property_types', models.JSONField(default=list)),
                ('description', models.TextField(blank=True, null=True)),
                ('total_chapters', models.IntegerField(blank=True, null=True)),
                ('total_pages', models.IntegerField(blank=True, null=True)),
                ('file_path', models.CharField(blank=True, max_length=500, null=True)),
                ('file_hash', models.CharField(blank=True, max_length=64, null=True)),
                ('file_size_bytes', models.BigIntegerField(blank=True, null=True)),
                ('ingestion_status', models.CharField(choices=[('pending', 'Pending'), ('processing', 'Processing'), ('indexed', 'Indexed'), ('failed', 'Failed')], default='pending', max_length=50)),
                ('chunk_count', models.IntegerField(default=0)),
                ('last_indexed_at', models.DateTimeField(blank=True, null=True)),
                ('is_active', models.BooleanField(default=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('created_by', models.CharField(default='system', max_length=100)),
            ],
            options={
                'verbose_name': 'Platform Knowledge Document',
                'verbose_name_plural': 'Platform Knowledge Documents',
                'db_table': 'landscape"."tbl_platform_knowledge',
            },
        ),
        migrations.RemoveField(
            model_name='knowledgeembedding',
            name='embedding',
        ),
        migrations.CreateModel(
            name='OpexBenchmark',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('source', models.CharField(db_index=True, max_length=50)),
                ('source_year', models.IntegerField(db_index=True)),
                ('report_name', models.CharField(blank=True, max_length=255, null=True)),
                ('property_type', models.CharField(choices=[('multifamily', 'Multifamily'), ('office', 'Office'), ('retail', 'Retail'), ('industrial', 'Industrial')], db_index=True, max_length=50)),
                ('property_subtype', models.CharField(blank=True, max_length=100, null=True)),
                ('geographic_scope', models.CharField(choices=[('national', 'National'), ('regional', 'Regional'), ('msa', 'MSA'), ('state', 'State')], max_length=50)),
                ('geography_name', models.CharField(blank=True, max_length=100, null=True)),
                ('expense_category', models.CharField(db_index=True, max_length=100)),
                ('expense_subcategory', models.CharField(blank=True, max_length=100, null=True)),
                ('per_unit_amount', models.DecimalField(blank=True, decimal_places=2, max_digits=12, null=True)),
                ('per_sf_amount', models.DecimalField(blank=True, decimal_places=4, max_digits=10, null=True)),
                ('pct_of_egi', models.DecimalField(blank=True, decimal_places=2, max_digits=5, null=True)),
                ('pct_of_gpi', models.DecimalField(blank=True, decimal_places=2, max_digits=5, null=True)),
                ('sample_size', models.IntegerField(blank=True, null=True)),
                ('sample_units', models.IntegerField(blank=True, null=True)),
                ('notes', models.TextField(blank=True, null=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
            ],
            options={
                'verbose_name': 'OpEx Benchmark',
                'verbose_name_plural': 'OpEx Benchmarks',
                'db_table': 'landscape"."opex_benchmark',
                'indexes': [models.Index(fields=['source', 'source_year'], name='opex_benchm_source_e217b6_idx'), models.Index(fields=['property_type', 'property_subtype'], name='opex_benchm_propert_9379f4_idx'), models.Index(fields=['expense_category', 'expense_subcategory'], name='opex_benchm_expense_41de22_idx'), models.Index(fields=['geographic_scope', 'geography_name'], name='opex_benchm_geograp_2c8d04_idx')],
                'unique_together': {('source', 'source_year', 'property_type', 'geographic_scope', 'geography_name', 'expense_category', 'expense_subcategory')},
            },
        ),
        migrations.CreateModel(
            name='PlatformKnowledgeChapter',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('chapter_number', models.IntegerField()),
                ('chapter_title', models.CharField(max_length=500)),
                ('page_start', models.IntegerField(blank=True, null=True)),
                ('page_end', models.IntegerField(blank=True, null=True)),
                ('topics', models.JSONField(default=list)),
                ('property_types', models.JSONField(default=list)),
                ('applies_to', models.JSONField(default=list)),
                ('summary', models.TextField(blank=True, null=True)),
                ('key_concepts', models.JSONField(default=dict)),
                ('chunk_ids', models.JSONField(default=list)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('document', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='chapters', to='knowledge.platformknowledge')),
            ],
            options={
                'db_table': 'landscape"."tbl_platform_knowledge_chapters',
                'ordering': ['document', 'chapter_number'],
                'unique_together': {('document', 'chapter_number')},
            },
        ),
        migrations.CreateModel(
            name='PlatformKnowledgeChunk',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('chunk_index', models.IntegerField()),
                ('content', models.TextField()),
                ('content_type', models.CharField(choices=[('text', 'Text'), ('table', 'Table'), ('formula', 'Formula'), ('example', 'Example'), ('list', 'List')], default='text', max_length=50)),
                ('page_number', models.IntegerField(blank=True, null=True)),
                ('section_path', models.CharField(blank=True, max_length=500, null=True)),
                ('embedding_model', models.CharField(default='text-embedding-3-small', max_length=100)),
                ('token_count', models.IntegerField(blank=True, null=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('chapter', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='chunks', to='knowledge.platformknowledgechapter')),
                ('document', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='chunks', to='knowledge.platformknowledge')),
            ],
            options={
                'db_table': 'landscape"."tbl_platform_knowledge_chunks',
                'ordering': ['document', 'chunk_index'],
                'unique_together': {('document', 'chunk_index')},
            },
        ),
    ]
